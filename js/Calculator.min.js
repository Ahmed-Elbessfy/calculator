let operation = document.querySelector("#operation"), display = document.querySelector("#display"), clear = document.querySelector("#clear"), divide = document.querySelector("#divide"), multiply = document.querySelector("#multiply"), seven = document.querySelector("#seven"), eight = document.querySelector("#eight"), nine = document.querySelector("#nine"), subtract = document.querySelector("#subtract"), four = document.querySelector("#four"), five = document.querySelector("#five"), six = document.querySelector("#six"), add = document.querySelector("#add"), three = document.querySelector("#three"), two = document.querySelector("#two"), one = document.querySelector("#one"), decimal = document.querySelector("#decimal"), zero = document.querySelector("#zero"), equal = document.querySelector("#equals"), numbers = [one, two, three, four, five, six, seven, eight, nine, zero, decimal]; operators = [add, subtract, divide, multiply], displayArr = [], tempResult = []; let initialNum = 0; const clearFun = () => { console.log("clearFun was called"), display.innerHTML = 0, operation.innerHTML = 0, displayArr = [], tempResult = [] }, controlDisplay = e => { if (["+", "*", "/"].includes(e)) { 0 !== tempResult.length && (displayArr = [], displayArr.push(tempResult[0]), tempResult = []); let l = [...displayArr].pop(); if (["+", "*", "/"].includes(l)) displayArr.pop(), displayArr.push(e); else if ("-" === l) { let l = displayArr[displayArr.length - 2];["+", "*", "/"].includes(l) && (displayArr.pop(), displayArr.pop(), displayArr.push(e)) } else displayArr.push(e) } else if ("-" === e) { 0 !== tempResult.length && (displayArr = [], displayArr.push(tempResult[0]), tempResult = []), "-" !== [...displayArr].pop() && displayArr.push(e) } else if ("." === e) { 0 !== tempResult.length && (displayArr = [], tempResult = []); let l = /[+\/*-]/, r = displayArr.join("").split(l); r[r.length - 1].includes(".") || (["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"].includes(displayArr[displayArr.length - 1]) ? displayArr.push(e) : (displayArr.push("0"), displayArr.push(e))) } else if ("0" === e) { if (0 !== tempResult.length && (displayArr = [], tempResult = []), "0" == [...displayArr].pop()) { let l = displayArr[displayArr.length - 2]; (["+", "/", "*", "-"].includes(l) || isNaN(l)) && "." != l || displayArr.push(e) } else displayArr.push(e) } else 0 !== tempResult.length && (displayArr = [], tempResult = []), displayArr.push(e); display.innerHTML = displayArr.join("") }, calculate = () => { let result = eval(displayArr.join("")); result !== Math.floor(result) && (result = +result.toFixed(5)), tempResult.push(result), operation.innerHTML = displayArr.join(""), display.innerHTML = `${result}` }; for (num of numbers) num.onclick = (e => controlDisplay(e.target.innerHTML)); for (operator of operators) operator.onclick = (e => controlDisplay(e.target.innerHTML)); display.innerHTML = initialNum, clear.addEventListener("click", clearFun), equal.addEventListener("click", calculate), document.addEventListener("keydown", e => { 96 != e.keyCode && 48 != e.keyCode || controlDisplay("0"), 97 != e.keyCode && 49 != e.keyCode || controlDisplay("1"), 98 != e.keyCode && 50 != e.keyCode || controlDisplay("2"), 99 != e.keyCode && 51 != e.keyCode || controlDisplay("3"), 100 != e.keyCode && 52 != e.keyCode || controlDisplay("4"), 101 != e.keyCode && 53 != e.keyCode || controlDisplay("5"), 102 != e.keyCode && 54 != e.keyCode || controlDisplay("6"), 103 != e.keyCode && 55 != e.keyCode || controlDisplay("7"), 104 != e.keyCode && 56 != e.keyCode || controlDisplay("8"), 105 != e.keyCode && 57 != e.keyCode || controlDisplay("9"), 110 == e.keyCode && controlDisplay("."), 190 == e.keyCode && e.shiftKey && controlDisplay("."), 107 == e.keyCode && controlDisplay("+"), 187 == e.keyCode && e.shiftKey && controlDisplay("+"), 109 == e.keyCode && controlDisplay("-"), 189 == e.keyCode && e.shiftKey && controlDisplay("-"), 106 == e.keyCode && controlDisplay("*"), 56 == e.keyCode && e.shiftKey && controlDisplay("*"), 111 == e.keyCode && controlDisplay("/"), 191 == e.keyCode && e.shiftKey && controlDisplay("/"), 13 == e.keyCode && calculate(), 187 == e.keyCode && calculate(), 46 === e.keyCode && clearFun() });